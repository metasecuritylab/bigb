\hypertarget{namespacelibElastic}{}\doxysection{lib\+Elastic Namespace Reference}
\label{namespacelibElastic}\index{libElastic@{libElastic}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacelibElastic_a25d918b17d86fbf8c47f141fdbd69aa6}{Check\+E\+LK}} (U\+RL)
\item 
def \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{Conv\+Epoch}} (dt)
\item 
def \mbox{\hyperlink{namespacelibElastic_a1abffa17e7c90468995f644ee8912b16}{Make\+Time\+Windows}} (start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{Get\+Agg\+Search}} (index, url, body, key=None)
\item 
def \mbox{\hyperlink{namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff}{Get\+List\+Search}} (index, url, body)
\item 
def \mbox{\hyperlink{namespacelibElastic_a4f39ace5df61644eb60df3b79be82c84}{Get\+Target\+List\+From\+Elastic}} (index, start, end, t\+IP, side)
\item 
def \mbox{\hyperlink{namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53}{Get\+I\+Ps\+From\+Elastic}} (start, end, side=None)
\item 
def \mbox{\hyperlink{namespacelibElastic_a00fdfab0c956dea9cc56e7f954af5860}{Get\+Log\+I\+PS}} (srcip, dstip, start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_a86d05edf3ec1141307f3b0f73cd22703}{Get\+Log\+FW}} (srcip, dstip, start, end, sport=0, dport=0)
\item 
def \mbox{\hyperlink{namespacelibElastic_a1e3034e8ebc79cb38c5ece2f8182924d}{Get\+Log\+W\+WW}} (uri, start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_a3e88121895b14e7d4c503bff1f3597b5}{Get\+Log\+Special}} (uri, start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_a8e8a318d1e8538c15f59fafee0b3ef2f}{Get\+Log\+Windows}} (hostname, start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_a99feb9d24cc1dbf1c848b607eb4e2d5f}{Get\+Log\+Linux}} (hostname, start, end)
\item 
def \mbox{\hyperlink{namespacelibElastic_ac9f97b29c42b49bb2a15cbd5bbdd4808}{Unit\+Test}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacelibElastic_afacdd35e09b0078a80e1fbd27d55a45e}{N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+U\+RL}} = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})
\item 
\mbox{\hyperlink{namespacelibElastic_a8bcd9d935c7a4aab8beb57bff8afeb09}{N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+A\+P\+I\+\_\+\+ID}} = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}A\+P\+I\+\_\+\+ID\textquotesingle{})
\item 
\mbox{\hyperlink{namespacelibElastic_a5fd390cb6a2abbba26d6ace3a44aa2eb}{N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+A\+P\+I\+\_\+\+K\+EY}} = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}A\+P\+I\+\_\+\+K\+EY\textquotesingle{})
\item 
\mbox{\hyperlink{namespacelibElastic_ac820bd125ae3427f2443608164191e04}{S\+Y\+S\+\_\+\+E\+L\+K\+\_\+\+U\+RL}} = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}S\+Y\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})
\item 
\mbox{\hyperlink{namespacelibElastic_a0d0fa8f1992b1e1b09cc7ea9a04703c8}{P\+A\+Y\+\_\+\+E\+L\+K\+\_\+\+U\+RL}} = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}P\+A\+Y\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacelibElastic_a25d918b17d86fbf8c47f141fdbd69aa6}\label{namespacelibElastic_a25d918b17d86fbf8c47f141fdbd69aa6}} 
\index{libElastic@{libElastic}!CheckELK@{CheckELK}}
\index{CheckELK@{CheckELK}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{CheckELK()}{CheckELK()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Check\+E\+LK (\begin{DoxyParamCaption}\item[{}]{U\+RL }\end{DoxyParamCaption})}



Definition at line 18 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a25d918b17d86fbf8c47f141fdbd69aa6}{CheckELK}}(URL):}
\DoxyCodeLine{19     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{20         elasticsearch.Elasticsearch(URL, timeout=30, max\_retries=10, retry\_on\_timeout=\textcolor{keyword}{True})}
\DoxyCodeLine{21     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{22         print(\textcolor{stringliteral}{'connection fail for ElasticSearch'})}
\DoxyCodeLine{23         \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25     \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{26 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}\label{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}} 
\index{libElastic@{libElastic}!ConvEpoch@{ConvEpoch}}
\index{ConvEpoch@{ConvEpoch}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{ConvEpoch()}{ConvEpoch()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Conv\+Epoch (\begin{DoxyParamCaption}\item[{}]{dt }\end{DoxyParamCaption})}



Definition at line 27 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{27 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(dt):}
\DoxyCodeLine{28     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{29         str\_dt = datetime.datetime.strptime(dt, \textcolor{stringliteral}{"\%Y-\/\%m-\/\%d \%H:\%M:\%S"})}
\DoxyCodeLine{30         epoch\_dt = int(str\_dt.timestamp()) * 1000}
\DoxyCodeLine{31     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{32         \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     \textcolor{keywordflow}{return} epoch\_dt}
\DoxyCodeLine{35 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}\label{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}} 
\index{libElastic@{libElastic}!GetAggSearch@{GetAggSearch}}
\index{GetAggSearch@{GetAggSearch}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetAggSearch()}{GetAggSearch()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Agg\+Search (\begin{DoxyParamCaption}\item[{}]{index,  }\item[{}]{url,  }\item[{}]{body,  }\item[{}]{key = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 58 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{58 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(index, url, body, key=None):}
\DoxyCodeLine{59     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{60         es\_client = elasticsearch.Elasticsearch(url, api\_key=key, verify\_certs=\textcolor{keyword}{False}, timeout=30,}
\DoxyCodeLine{61                                                 max\_retries=10, retry\_on\_timeout=\textcolor{keyword}{True})}
\DoxyCodeLine{62     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{63         print(\textcolor{stringliteral}{'connection fail for ElasticSearch'})}
\DoxyCodeLine{64         \textcolor{keywordflow}{return} \textcolor{keyword}{False}, 0}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     res = es\_client.search(index=index, body=body)}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{keywordflow}{return} res}
\DoxyCodeLine{69 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53}\label{namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53}} 
\index{libElastic@{libElastic}!GetIPsFromElastic@{GetIPsFromElastic}}
\index{GetIPsFromElastic@{GetIPsFromElastic}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetIPsFromElastic()}{GetIPsFromElastic()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+I\+Ps\+From\+Elastic (\begin{DoxyParamCaption}\item[{}]{start,  }\item[{}]{end,  }\item[{}]{side = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 134 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{134 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53}{GetIPsFromElastic}}(start, end, side=None):}
\DoxyCodeLine{135     \textcolor{comment}{\# Call playbook}}
\DoxyCodeLine{136     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} side:}
\DoxyCodeLine{137         \textcolor{keywordflow}{return} \{\}, 0}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{140         es\_client = elasticsearch.Elasticsearch(NSS\_ELK\_URL, api\_key=(NSS\_ELK\_API\_ID, NSS\_ELK\_API\_KEY),}
\DoxyCodeLine{141                                                 verify\_certs=\textcolor{keyword}{False}, timeout=30, max\_retries=1, retry\_on\_timeout=\textcolor{keyword}{True})}
\DoxyCodeLine{142     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{143         \textcolor{keywordflow}{return} \{\}, 0}
\DoxyCodeLine{144 }
\DoxyCodeLine{145     dst = \{\}}
\DoxyCodeLine{146     hits = 0}
\DoxyCodeLine{147     size = 10000}
\DoxyCodeLine{148     windows = \mbox{\hyperlink{namespacelibElastic_a1abffa17e7c90468995f644ee8912b16}{MakeTimeWindows}}(start, end)}
\DoxyCodeLine{149     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} windows:}
\DoxyCodeLine{150         body = \mbox{\hyperlink{namespacelibDsl_a452f82834d7e0d601d9fe05653848eb4}{libDsl.GetIPsBySide}}(item[\textcolor{stringliteral}{'start'}], item[\textcolor{stringliteral}{'end'}], Lhits=0, Laggs=size, side=side)}
\DoxyCodeLine{151         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{152             response = es\_client.search(index=\textcolor{stringliteral}{'nss-\/fw-\/*'}, body=body)}
\DoxyCodeLine{153         \textcolor{keywordflow}{except}:}
\DoxyCodeLine{154             \textcolor{keywordflow}{return} \{\}, 0}
\DoxyCodeLine{155 }
\DoxyCodeLine{156         sum\_other\_doc\_count = response[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'data'}][\textcolor{stringliteral}{'sum\_other\_doc\_count'}]}
\DoxyCodeLine{157 }
\DoxyCodeLine{158         \textcolor{keywordflow}{if} sum\_other\_doc\_count > 0:}
\DoxyCodeLine{159             print(\textcolor{stringliteral}{'fail to clear sum other doc count'})}
\DoxyCodeLine{160 }
\DoxyCodeLine{161         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} response[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'data'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{162             \textcolor{keywordflow}{if} j[\textcolor{stringliteral}{'key'}] \textcolor{keywordflow}{in} dst:}
\DoxyCodeLine{163                 dst[j[\textcolor{stringliteral}{'key'}]] += j[\textcolor{stringliteral}{'doc\_count'}]}
\DoxyCodeLine{164             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{165                 dst[j[\textcolor{stringliteral}{'key'}]] = j[\textcolor{stringliteral}{'doc\_count'}]}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} dst:}
\DoxyCodeLine{168         hits = hits + dst[item]}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     \textcolor{keywordflow}{return} dst, hits}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{d7/d42/namespacelibElastic_af738286aa3fc1bf136ff8212331e6b53_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff}\label{namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff}} 
\index{libElastic@{libElastic}!GetListSearch@{GetListSearch}}
\index{GetListSearch@{GetListSearch}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetListSearch()}{GetListSearch()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+List\+Search (\begin{DoxyParamCaption}\item[{}]{index,  }\item[{}]{url,  }\item[{}]{body }\end{DoxyParamCaption})}



Definition at line 70 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{70 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff}{GetListSearch}}(index, url, body):}
\DoxyCodeLine{71     retVal = []}
\DoxyCodeLine{72     \_KEEP\_ALIVE\_LIMIT = \textcolor{stringliteral}{'30s'}}
\DoxyCodeLine{73     size = 100}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{76         es\_client = elasticsearch.Elasticsearch(url, verify\_certs=\textcolor{keyword}{False}, timeout=30, max\_retries=10,}
\DoxyCodeLine{77                                                 retry\_on\_timeout=\textcolor{keyword}{True})}
\DoxyCodeLine{78     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{79         print(\textcolor{stringliteral}{'connection fail for ElasticSearch'})}
\DoxyCodeLine{80         \textcolor{keywordflow}{return} \textcolor{keyword}{False}, 0}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     res = es\_client.search(index=index, scroll=\_KEEP\_ALIVE\_LIMIT, size=size, body=body)}
\DoxyCodeLine{83     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{84         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     sid = res[\textcolor{stringliteral}{'\_scroll\_id'}]}
\DoxyCodeLine{87     fetched = len(res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'hits'}])}
\DoxyCodeLine{88     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(fetched):}
\DoxyCodeLine{89         retVal.append(res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'hits'}][i][\textcolor{stringliteral}{'\_source'}][\textcolor{stringliteral}{'message'}])}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{keywordflow}{while} (fetched > 0):}
\DoxyCodeLine{92         res = es\_client.scroll(scroll\_id=sid, scroll=\_KEEP\_ALIVE\_LIMIT)}
\DoxyCodeLine{93         fetched = len(res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'hits'}])}
\DoxyCodeLine{94         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(fetched):}
\DoxyCodeLine{95             retVal.append(res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'hits'}][i][\textcolor{stringliteral}{'\_source'}][\textcolor{stringliteral}{'message'}])}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{98 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a86d05edf3ec1141307f3b0f73cd22703}\label{namespacelibElastic_a86d05edf3ec1141307f3b0f73cd22703}} 
\index{libElastic@{libElastic}!GetLogFW@{GetLogFW}}
\index{GetLogFW@{GetLogFW}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogFW()}{GetLogFW()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+FW (\begin{DoxyParamCaption}\item[{}]{srcip,  }\item[{}]{dstip,  }\item[{}]{start,  }\item[{}]{end,  }\item[{}]{sport = {\ttfamily 0},  }\item[{}]{dport = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line 193 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{193 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a86d05edf3ec1141307f3b0f73cd22703}{GetLogFW}}(srcip, dstip, start, end, sport=0, dport=0):}
\DoxyCodeLine{194     retVal = []}
\DoxyCodeLine{195     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{196     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{197     body = \mbox{\hyperlink{namespacelibDsl_af2927ec650c66cd86ba99889d8140835}{libDsl.logfw}}(srcip, dstip, sEpoch, eEpoch, sport, dport)}
\DoxyCodeLine{198     res = \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(\textcolor{stringliteral}{'nss-\/fw-\/*'}, NSS\_ELK\_URL, body, (NSS\_ELK\_API\_ID, NSS\_ELK\_API\_KEY))}
\DoxyCodeLine{199     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{200         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     src = res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'key'}]}
\DoxyCodeLine{203     dst = res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'5'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'key'}]}
\DoxyCodeLine{204 }
\DoxyCodeLine{205     \textcolor{keywordflow}{for} sport \textcolor{keywordflow}{in} res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'5'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{206         \textcolor{keywordflow}{for} dport \textcolor{keywordflow}{in} sport[\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'6'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{207             \textcolor{keywordflow}{for} action \textcolor{keywordflow}{in} dport[\textcolor{stringliteral}{'4'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{208                 text = \textcolor{stringliteral}{"\{\}:\{\}-\/>\{\}:\{\} \{\}"}.format(src, sport[\textcolor{stringliteral}{'key'}], dst, dport[\textcolor{stringliteral}{'key'}], action[\textcolor{stringliteral}{'key'}])}
\DoxyCodeLine{209                 retVal.append(text)}
\DoxyCodeLine{210 }
\DoxyCodeLine{211     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{212 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a86d05edf3ec1141307f3b0f73cd22703_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a00fdfab0c956dea9cc56e7f954af5860}\label{namespacelibElastic_a00fdfab0c956dea9cc56e7f954af5860}} 
\index{libElastic@{libElastic}!GetLogIPS@{GetLogIPS}}
\index{GetLogIPS@{GetLogIPS}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogIPS()}{GetLogIPS()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+I\+PS (\begin{DoxyParamCaption}\item[{}]{srcip,  }\item[{}]{dstip,  }\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 173 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{173 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a00fdfab0c956dea9cc56e7f954af5860}{GetLogIPS}}(srcip, dstip, start, end):}
\DoxyCodeLine{174     retVal = []}
\DoxyCodeLine{175     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{176     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     body = \mbox{\hyperlink{namespacelibDsl_a98ca675752de9bfe73445f352c515968}{libDsl.logips}}(srcip, dstip, sEpoch, eEpoch)}
\DoxyCodeLine{179     res = \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(\textcolor{stringliteral}{'ips-\/*'}, PAY\_ELK\_URL, body)}
\DoxyCodeLine{180 }
\DoxyCodeLine{181     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{182         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{183 }
\DoxyCodeLine{184     src = res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'key'}]}
\DoxyCodeLine{185     dst = res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'key'}]}
\DoxyCodeLine{186 }
\DoxyCodeLine{187     \textcolor{keywordflow}{for} event \textcolor{keywordflow}{in} res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}][0][\textcolor{stringliteral}{'4'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{188         text = \textcolor{stringliteral}{"\{\}-\/>\{\}, \{\}, \{\}"}.format(src, dst, event[\textcolor{stringliteral}{'key'}], event[\textcolor{stringliteral}{'doc\_count'}])}
\DoxyCodeLine{189         retVal.append(text)}
\DoxyCodeLine{190 }
\DoxyCodeLine{191     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{192 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a00fdfab0c956dea9cc56e7f954af5860_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a99feb9d24cc1dbf1c848b607eb4e2d5f}\label{namespacelibElastic_a99feb9d24cc1dbf1c848b607eb4e2d5f}} 
\index{libElastic@{libElastic}!GetLogLinux@{GetLogLinux}}
\index{GetLogLinux@{GetLogLinux}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogLinux()}{GetLogLinux()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+Linux (\begin{DoxyParamCaption}\item[{}]{hostname,  }\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 266 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{266 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a99feb9d24cc1dbf1c848b607eb4e2d5f}{GetLogLinux}}(hostname, start, end):}
\DoxyCodeLine{267     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{268     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{269 }
\DoxyCodeLine{270     body = \mbox{\hyperlink{namespacelibDsl_a79e8b62f355d41a65f7991a6e8694771}{libDsl.loglinux}}(hostname, sEpoch, eEpoch)}
\DoxyCodeLine{271     ret = \mbox{\hyperlink{namespacelibElastic_ad99e1578c316730d6971efff8d9c31ff}{GetListSearch}}(\textcolor{stringliteral}{'syslog-\/linux-\/*'}, SYS\_ELK\_URL, body)}
\DoxyCodeLine{272 }
\DoxyCodeLine{273     \textcolor{keywordflow}{return} ret}
\DoxyCodeLine{274 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a99feb9d24cc1dbf1c848b607eb4e2d5f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a3e88121895b14e7d4c503bff1f3597b5}\label{namespacelibElastic_a3e88121895b14e7d4c503bff1f3597b5}} 
\index{libElastic@{libElastic}!GetLogSpecial@{GetLogSpecial}}
\index{GetLogSpecial@{GetLogSpecial}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogSpecial()}{GetLogSpecial()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+Special (\begin{DoxyParamCaption}\item[{}]{uri,  }\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 231 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{231 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a3e88121895b14e7d4c503bff1f3597b5}{GetLogSpecial}}(uri, start, end):}
\DoxyCodeLine{232     retVal = []}
\DoxyCodeLine{233     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{234     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{235 }
\DoxyCodeLine{236     body = \mbox{\hyperlink{namespacelibDsl_acb7bb73ec264b4d957e1d39ace991328}{libDsl.logwww}}(uri, sEpoch, eEpoch)}
\DoxyCodeLine{237     res = \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(\textcolor{stringliteral}{'weblog-\/special-\/*'}, SYS\_ELK\_URL, body)}
\DoxyCodeLine{238 }
\DoxyCodeLine{239     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{240         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{243         \textcolor{keywordflow}{for} srcip \textcolor{keywordflow}{in} status[\textcolor{stringliteral}{'4'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{244             text = \textcolor{stringliteral}{"\{\} \{\} \{\}"}.format(status[\textcolor{stringliteral}{'key'}], srcip[\textcolor{stringliteral}{'key'}], srcip[\textcolor{stringliteral}{'doc\_count'}])}
\DoxyCodeLine{245             retVal.append(text)}
\DoxyCodeLine{246 }
\DoxyCodeLine{247     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{248 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a3e88121895b14e7d4c503bff1f3597b5_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a8e8a318d1e8538c15f59fafee0b3ef2f}\label{namespacelibElastic_a8e8a318d1e8538c15f59fafee0b3ef2f}} 
\index{libElastic@{libElastic}!GetLogWindows@{GetLogWindows}}
\index{GetLogWindows@{GetLogWindows}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogWindows()}{GetLogWindows()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+Windows (\begin{DoxyParamCaption}\item[{}]{hostname,  }\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 249 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{249 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a8e8a318d1e8538c15f59fafee0b3ef2f}{GetLogWindows}}(hostname, start, end):}
\DoxyCodeLine{250     retVal = []}
\DoxyCodeLine{251     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{252     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{253 }
\DoxyCodeLine{254     body = \mbox{\hyperlink{namespacelibDsl_a2a0f0ca04a8ff9e2e2c70ea37682bbc5}{libDsl.logwindows}}(hostname, sEpoch, eEpoch)}
\DoxyCodeLine{255     res = \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(\textcolor{stringliteral}{'syslog-\/windows-\/*'}, SYS\_ELK\_URL, body)}
\DoxyCodeLine{256 }
\DoxyCodeLine{257     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{258         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{keywordflow}{for} eventcode \textcolor{keywordflow}{in} res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'2'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{261         text = \textcolor{stringliteral}{"\{\} \{\}"}.format(eventcode[\textcolor{stringliteral}{'key'}], eventcode[\textcolor{stringliteral}{'doc\_count'}])}
\DoxyCodeLine{262         retVal.append(text)}
\DoxyCodeLine{263 }
\DoxyCodeLine{264     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{265 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a8e8a318d1e8538c15f59fafee0b3ef2f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a1e3034e8ebc79cb38c5ece2f8182924d}\label{namespacelibElastic_a1e3034e8ebc79cb38c5ece2f8182924d}} 
\index{libElastic@{libElastic}!GetLogWWW@{GetLogWWW}}
\index{GetLogWWW@{GetLogWWW}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetLogWWW()}{GetLogWWW()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Log\+W\+WW (\begin{DoxyParamCaption}\item[{}]{uri,  }\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 213 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{213 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a1e3034e8ebc79cb38c5ece2f8182924d}{GetLogWWW}}(uri, start, end):}
\DoxyCodeLine{214     retVal = []}
\DoxyCodeLine{215     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{216     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     body = \mbox{\hyperlink{namespacelibDsl_acb7bb73ec264b4d957e1d39ace991328}{libDsl.logwww}}(uri, sEpoch, eEpoch)}
\DoxyCodeLine{219     res = \mbox{\hyperlink{namespacelibElastic_a94fa5cac2bc1c7bf3b9da57375f97abe}{GetAggSearch}}(\textcolor{stringliteral}{'weblog-\/www-\/*'}, SYS\_ELK\_URL, body)}
\DoxyCodeLine{220 }
\DoxyCodeLine{221     \textcolor{keywordflow}{if} res[\textcolor{stringliteral}{'hits'}][\textcolor{stringliteral}{'total'}][\textcolor{stringliteral}{'value'}] < 1:}
\DoxyCodeLine{222         \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} res[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'3'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{225         \textcolor{keywordflow}{for} srcip \textcolor{keywordflow}{in} status[\textcolor{stringliteral}{'4'}][\textcolor{stringliteral}{'buckets'}]:}
\DoxyCodeLine{226             text = \textcolor{stringliteral}{"\{\} \{\} \{\}"}.format(status[\textcolor{stringliteral}{'key'}], srcip[\textcolor{stringliteral}{'key'}], srcip[\textcolor{stringliteral}{'doc\_count'}])}
\DoxyCodeLine{227             retVal.append(text)}
\DoxyCodeLine{228 }
\DoxyCodeLine{229     \textcolor{keywordflow}{return} retVal}
\DoxyCodeLine{230 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a1e3034e8ebc79cb38c5ece2f8182924d_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a4f39ace5df61644eb60df3b79be82c84}\label{namespacelibElastic_a4f39ace5df61644eb60df3b79be82c84}} 
\index{libElastic@{libElastic}!GetTargetListFromElastic@{GetTargetListFromElastic}}
\index{GetTargetListFromElastic@{GetTargetListFromElastic}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{GetTargetListFromElastic()}{GetTargetListFromElastic()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Get\+Target\+List\+From\+Elastic (\begin{DoxyParamCaption}\item[{}]{index,  }\item[{}]{start,  }\item[{}]{end,  }\item[{}]{t\+IP,  }\item[{}]{side }\end{DoxyParamCaption})}



Definition at line 99 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{99 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a4f39ace5df61644eb60df3b79be82c84}{GetTargetListFromElastic}}(index, start, end, tIP, side):}
\DoxyCodeLine{100     \textcolor{comment}{\# Call API}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{103     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{104     windows = [100, 500, 1000, 1500, 2000]}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{107         es\_client = elasticsearch.Elasticsearch(NSS\_ELK\_URL, timeout=30, max\_retries=10, retry\_on\_timeout=\textcolor{keyword}{True})}
\DoxyCodeLine{108     \textcolor{keywordflow}{except}:}
\DoxyCodeLine{109         \textcolor{keywordflow}{return} \textcolor{keyword}{False}, 0}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     sum\_other\_doc\_count = 10}
\DoxyCodeLine{112     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} windows:}
\DoxyCodeLine{113         \textcolor{keywordflow}{if} sum\_other\_doc\_count < 1:}
\DoxyCodeLine{114             \textcolor{keywordflow}{break}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordflow}{if} side == \textcolor{stringliteral}{'src'}:}
\DoxyCodeLine{117             body = \mbox{\hyperlink{namespacelibDsl_a0bb5b220a08e2e43b61663c87824af8a}{libDsl.GetIPsByTarget}}(sEpoch, eEpoch, Lhits=0, Laggs=item, dstip=tIP, srcip=\textcolor{keywordtype}{None})}
\DoxyCodeLine{118         \textcolor{keywordflow}{elif} side == \textcolor{stringliteral}{'dst'}:}
\DoxyCodeLine{119             body = \mbox{\hyperlink{namespacelibDsl_a0bb5b220a08e2e43b61663c87824af8a}{libDsl.GetIPsByTarget}}(sEpoch, eEpoch, Lhits=0, Laggs=item, dstip=\textcolor{keywordtype}{None}, srcip=tIP)}
\DoxyCodeLine{120         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{121             \textcolor{keywordflow}{return} \textcolor{keyword}{False}, 0}
\DoxyCodeLine{122 }
\DoxyCodeLine{123         response = es\_client.search(index=index, body=body)}
\DoxyCodeLine{124         sum\_other\_doc\_count = response[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'data'}][\textcolor{stringliteral}{'sum\_other\_doc\_count'}]}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{keywordflow}{if} sum\_other\_doc\_count > 1:}
\DoxyCodeLine{127         \textcolor{keywordflow}{return} \textcolor{keyword}{False}, 0}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     bucket = response[\textcolor{stringliteral}{'aggregations'}][\textcolor{stringliteral}{'data'}][\textcolor{stringliteral}{'buckets'}]}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{keywordflow}{return} bucket, len(bucket)}
\DoxyCodeLine{132 }
\DoxyCodeLine{133 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a4f39ace5df61644eb60df3b79be82c84_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_a1abffa17e7c90468995f644ee8912b16}\label{namespacelibElastic_a1abffa17e7c90468995f644ee8912b16}} 
\index{libElastic@{libElastic}!MakeTimeWindows@{MakeTimeWindows}}
\index{MakeTimeWindows@{MakeTimeWindows}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{MakeTimeWindows()}{MakeTimeWindows()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Make\+Time\+Windows (\begin{DoxyParamCaption}\item[{}]{start,  }\item[{}]{end }\end{DoxyParamCaption})}



Definition at line 36 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{36 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_a1abffa17e7c90468995f644ee8912b16}{MakeTimeWindows}}(start, end):}
\DoxyCodeLine{37     windows = 100000}
\DoxyCodeLine{38     sEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(start)}
\DoxyCodeLine{39     eEpoch = \mbox{\hyperlink{namespacelibElastic_a00bde85e525eabda933a98374d8fa0e2}{ConvEpoch}}(end)}
\DoxyCodeLine{40     wDate = list()}
\DoxyCodeLine{41     sTime = sEpoch}
\DoxyCodeLine{42     eTime = 0}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{keywordflow}{while} \textcolor{keyword}{True}:}
\DoxyCodeLine{45         \textcolor{keywordflow}{if} eTime == eEpoch:}
\DoxyCodeLine{46             \textcolor{keywordflow}{break}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48         eTime = sTime + windows}
\DoxyCodeLine{49         \textcolor{keywordflow}{if} eTime > eEpoch:}
\DoxyCodeLine{50             eTime = eEpoch}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         text = \{\textcolor{stringliteral}{'start'}: sTime, \textcolor{stringliteral}{'end'}: eTime\}}
\DoxyCodeLine{53         wDate.append(text)}
\DoxyCodeLine{54         sTime = eTime + 1}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{keywordflow}{return} wDate}
\DoxyCodeLine{57 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a1abffa17e7c90468995f644ee8912b16_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d42/namespacelibElastic_a1abffa17e7c90468995f644ee8912b16_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacelibElastic_ac9f97b29c42b49bb2a15cbd5bbdd4808}\label{namespacelibElastic_ac9f97b29c42b49bb2a15cbd5bbdd4808}} 
\index{libElastic@{libElastic}!UnitTest@{UnitTest}}
\index{UnitTest@{UnitTest}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{UnitTest()}{UnitTest()}}
{\footnotesize\ttfamily def lib\+Elastic.\+Unit\+Test (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 275 of file lib\+Elastic.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{275 \textcolor{keyword}{def }\mbox{\hyperlink{namespacelibElastic_ac9f97b29c42b49bb2a15cbd5bbdd4808}{UnitTest}}():}
\DoxyCodeLine{276     \mbox{\hyperlink{namespacelibUtils_a237cdae37726b25124e805fe3bbd638d}{libUtils.UnitTestPrint}}(\textcolor{keyword}{True}, \textcolor{stringliteral}{'libElastic'}, \textcolor{stringliteral}{'GetLogLinux'}, 1)}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{d7/d42/namespacelibElastic_ac9f97b29c42b49bb2a15cbd5bbdd4808_cgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacelibElastic_a8bcd9d935c7a4aab8beb57bff8afeb09}\label{namespacelibElastic_a8bcd9d935c7a4aab8beb57bff8afeb09}} 
\index{libElastic@{libElastic}!NSS\_ELK\_API\_ID@{NSS\_ELK\_API\_ID}}
\index{NSS\_ELK\_API\_ID@{NSS\_ELK\_API\_ID}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{NSS\_ELK\_API\_ID}{NSS\_ELK\_API\_ID}}
{\footnotesize\ttfamily lib\+Elastic.\+N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+A\+P\+I\+\_\+\+ID = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}A\+P\+I\+\_\+\+ID\textquotesingle{})}



Definition at line 13 of file lib\+Elastic.\+py.

\mbox{\Hypertarget{namespacelibElastic_a5fd390cb6a2abbba26d6ace3a44aa2eb}\label{namespacelibElastic_a5fd390cb6a2abbba26d6ace3a44aa2eb}} 
\index{libElastic@{libElastic}!NSS\_ELK\_API\_KEY@{NSS\_ELK\_API\_KEY}}
\index{NSS\_ELK\_API\_KEY@{NSS\_ELK\_API\_KEY}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{NSS\_ELK\_API\_KEY}{NSS\_ELK\_API\_KEY}}
{\footnotesize\ttfamily lib\+Elastic.\+N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+A\+P\+I\+\_\+\+K\+EY = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}A\+P\+I\+\_\+\+K\+EY\textquotesingle{})}



Definition at line 14 of file lib\+Elastic.\+py.

\mbox{\Hypertarget{namespacelibElastic_afacdd35e09b0078a80e1fbd27d55a45e}\label{namespacelibElastic_afacdd35e09b0078a80e1fbd27d55a45e}} 
\index{libElastic@{libElastic}!NSS\_ELK\_URL@{NSS\_ELK\_URL}}
\index{NSS\_ELK\_URL@{NSS\_ELK\_URL}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{NSS\_ELK\_URL}{NSS\_ELK\_URL}}
{\footnotesize\ttfamily lib\+Elastic.\+N\+S\+S\+\_\+\+E\+L\+K\+\_\+\+U\+RL = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}N\+S\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})}



Definition at line 12 of file lib\+Elastic.\+py.

\mbox{\Hypertarget{namespacelibElastic_a0d0fa8f1992b1e1b09cc7ea9a04703c8}\label{namespacelibElastic_a0d0fa8f1992b1e1b09cc7ea9a04703c8}} 
\index{libElastic@{libElastic}!PAY\_ELK\_URL@{PAY\_ELK\_URL}}
\index{PAY\_ELK\_URL@{PAY\_ELK\_URL}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{PAY\_ELK\_URL}{PAY\_ELK\_URL}}
{\footnotesize\ttfamily lib\+Elastic.\+P\+A\+Y\+\_\+\+E\+L\+K\+\_\+\+U\+RL = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}P\+A\+Y\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})}



Definition at line 16 of file lib\+Elastic.\+py.

\mbox{\Hypertarget{namespacelibElastic_ac820bd125ae3427f2443608164191e04}\label{namespacelibElastic_ac820bd125ae3427f2443608164191e04}} 
\index{libElastic@{libElastic}!SYS\_ELK\_URL@{SYS\_ELK\_URL}}
\index{SYS\_ELK\_URL@{SYS\_ELK\_URL}!libElastic@{libElastic}}
\doxysubsubsection{\texorpdfstring{SYS\_ELK\_URL}{SYS\_ELK\_URL}}
{\footnotesize\ttfamily lib\+Elastic.\+S\+Y\+S\+\_\+\+E\+L\+K\+\_\+\+U\+RL = \mbox{\hyperlink{namespacelibConfig_a51052c0d8eb9598b29b3bbcab309eb1b}{lib\+Config.\+Get\+Config}}(\textquotesingle{}S\+Y\+S\+\_\+\+E\+L\+A\+S\+T\+IC\textquotesingle{}, \textquotesingle{}U\+RL\textquotesingle{})}



Definition at line 15 of file lib\+Elastic.\+py.

